{
  "objects": [
    {
      "attributes": {
        "description": "Dashboard for the DNP3 Protocol",
        "hits": 0,
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"highlightAll\":false,\"version\":true,\"query\":{\"language\":\"lucene\",\"query\":\"\"},\"filter\":[]}"
        },
        "optionsJSON": "{\"useMargins\":true}",
        "panelsJSON": "[{\"version\":\"3.3.0\",\"gridData\":{\"x\":0,\"y\":0,\"w\":8,\"h\":37,\"i\":\"1\"},\"panelIndex\":\"1\",\"embeddableConfig\":{},\"panelRefName\":\"panel_0\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":0,\"y\":37,\"w\":13,\"h\":19,\"i\":\"7\"},\"panelIndex\":\"7\",\"embeddableConfig\":{\"params\":{\"sort\":{\"columnIndex\":1,\"direction\":\"asc\"}},\"vis\":{\"params\":{\"sort\":{\"columnIndex\":1,\"direction\":\"desc\"}}}},\"panelRefName\":\"panel_1\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":13,\"y\":37,\"w\":11,\"h\":19,\"i\":\"8\"},\"panelIndex\":\"8\",\"embeddableConfig\":{\"params\":{\"sort\":{\"columnIndex\":1,\"direction\":\"asc\"}},\"vis\":{\"params\":{\"sort\":{\"columnIndex\":1,\"direction\":\"desc\"}}}},\"panelRefName\":\"panel_2\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":8,\"y\":18,\"w\":11,\"h\":19,\"i\":\"13\"},\"panelIndex\":\"13\",\"embeddableConfig\":{\"params\":{\"sort\":{\"columnIndex\":1,\"direction\":\"asc\"}},\"vis\":{\"params\":{\"sort\":{\"columnIndex\":1,\"direction\":\"desc\"}}}},\"panelRefName\":\"panel_3\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":19,\"y\":18,\"w\":10,\"h\":19,\"i\":\"14\"},\"panelIndex\":\"14\",\"embeddableConfig\":{\"params\":{\"sort\":{\"columnIndex\":1,\"direction\":\"asc\"}},\"vis\":{\"params\":{\"sort\":{\"columnIndex\":1,\"direction\":\"desc\"}}}},\"panelRefName\":\"panel_4\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":8,\"y\":0,\"w\":10,\"h\":18,\"i\":\"0d2c1a60-2ee6-46a5-8c6f-e5a95a1f5850\"},\"panelIndex\":\"0d2c1a60-2ee6-46a5-8c6f-e5a95a1f5850\",\"embeddableConfig\":{},\"panelRefName\":\"panel_5\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":18,\"y\":0,\"w\":30,\"h\":18,\"i\":\"6f17ed53-0ae8-4260-acd7-92115f40037c\"},\"panelIndex\":\"6f17ed53-0ae8-4260-acd7-92115f40037c\",\"embeddableConfig\":{\"legendOpen\":false,\"vis\":{\"legendOpen\":true}},\"panelRefName\":\"panel_6\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":29,\"y\":18,\"w\":19,\"h\":19,\"i\":\"dc74966e-dd3d-4277-a4c0-92a2b21d1214\"},\"panelIndex\":\"dc74966e-dd3d-4277-a4c0-92a2b21d1214\",\"embeddableConfig\":{},\"panelRefName\":\"panel_7\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":24,\"y\":37,\"w\":24,\"h\":37,\"i\":\"0242ac86-f482-429a-bc77-89eb89eb7996\"},\"panelIndex\":\"0242ac86-f482-429a-bc77-89eb89eb7996\",\"embeddableConfig\":{\"params\":{\"sort\":{\"columnIndex\":4,\"direction\":\"asc\"}},\"vis\":{\"params\":{\"sort\":{\"columnIndex\":4,\"direction\":\"desc\"}}}},\"panelRefName\":\"panel_8\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":0,\"y\":56,\"w\":24,\"h\":18,\"i\":\"9fddb0ae-d93f-4ecb-8625-ccd87a92e175\"},\"panelIndex\":\"9fddb0ae-d93f-4ecb-8625-ccd87a92e175\",\"embeddableConfig\":{\"params\":{\"sort\":{\"columnIndex\":6,\"direction\":\"asc\"}},\"vis\":{\"params\":{\"sort\":{\"columnIndex\":6,\"direction\":\"desc\"}}}},\"panelRefName\":\"panel_9\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":0,\"y\":74,\"w\":48,\"h\":28,\"i\":\"8645bfcf-8f16-4e58-8e99-40e8e6ba6326\"},\"panelIndex\":\"8645bfcf-8f16-4e58-8e99-40e8e6ba6326\",\"embeddableConfig\":{},\"panelRefName\":\"panel_10\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":0,\"y\":102,\"w\":48,\"h\":23,\"i\":\"20bab908-6058-4f9a-819b-de9011dd65b0\"},\"panelIndex\":\"20bab908-6058-4f9a-819b-de9011dd65b0\",\"embeddableConfig\":{},\"panelRefName\":\"panel_11\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":0,\"y\":125,\"w\":48,\"h\":20,\"i\":\"f4c2ba58-794b-4b5a-b65e-3cb6a924f199\"},\"panelIndex\":\"f4c2ba58-794b-4b5a-b65e-3cb6a924f199\",\"embeddableConfig\":{},\"panelRefName\":\"panel_12\"},{\"version\":\"3.3.0\",\"gridData\":{\"x\":0,\"y\":145,\"w\":48,\"h\":18,\"i\":\"842b0a10-1906-4b1f-9da3-f6b271a85dcb\"},\"panelIndex\":\"842b0a10-1906-4b1f-9da3-f6b271a85dcb\",\"embeddableConfig\":{},\"panelRefName\":\"panel_13\"}]",
        "timeRestore": false,
        "title": "DNP3",
        "version": 1
      },
      "id": "870a5862-6c26-4a08-99fd-0c06cda85ba3",
      "migrationVersion": {
        "dashboard": "7.9.3"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "df9e399b-efa5-4e33-b0ac-a7668a8ac2b3",
          "name": "panel_0",
          "type": "visualization"
        },
        {
          "id": "d34dd3b3-3861-4b9b-ba39-4ca7e15b3bdd",
          "name": "panel_1",
          "type": "visualization"
        },
        {
          "id": "131198e7-afc4-40be-bedd-2a3a3a2d511e",
          "name": "panel_2",
          "type": "visualization"
        },
        {
          "id": "46cd2e4c-ecfb-4fe9-ae51-28c2fecbffc0",
          "name": "panel_3",
          "type": "visualization"
        },
        {
          "id": "9422ff81-b007-4eef-aca1-1af16509ab8c",
          "name": "panel_4",
          "type": "visualization"
        },
        {
          "id": "34700240-cb66-11ea-b8b9-778c41cae039",
          "name": "panel_5",
          "type": "visualization"
        },
        {
          "id": "4f7c9990-cb66-11ea-b8b9-778c41cae039",
          "name": "panel_6",
          "type": "visualization"
        },
        {
          "id": "9277d050-e33c-11ea-b05f-2302f75ab2c8",
          "name": "panel_7",
          "type": "visualization"
        },
        {
          "id": "fd7d74c0-e339-11ea-b05f-2302f75ab2c8",
          "name": "panel_8",
          "type": "visualization"
        },
        {
          "id": "63cebc10-e33b-11ea-b05f-2302f75ab2c8",
          "name": "panel_9",
          "type": "visualization"
        },
        {
          "id": "d7f669a0-cfa1-11f0-b77d-79037ad18c51",
          "name": "panel_10",
          "type": "visualization"
        },
        {
          "id": "cc135a63-3e30-4703-bc31-f7ac09c1d21a",
          "name": "panel_11",
          "type": "search"
        },
        {
          "id": "980f33d0-cb65-11ea-b8b9-778c41cae039",
          "name": "panel_12",
          "type": "search"
        },
        {
          "id": "cf32a680-cb65-11ea-b8b9-778c41cae039",
          "name": "panel_13",
          "type": "search"
        }
      ],
      "type": "dashboard",
      "updated_at": "2025-12-02T17:56:35.188Z",
      "version": "WzEzMDAsMV0="
    },
    {
      "attributes": {
        "description": "",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"query\":{\"query\":{\"query_string\":{\"query\":\"*\"}},\"language\":\"lucene\"},\"filter\":[]}"
        },
        "title": "Navigation",
        "uiStateJSON": "{}",
        "version": 1,
        "visState": "{\"title\":\"Navigation\",\"type\":\"markdown\",\"params\":{\"markdown\":\"MALCOLM_NAVIGATION_MARKDOWN_REPLACER\",\"type\":\"markdown\",\"fontSize\":10,\"openLinksInNewTab\":false},\"aggs\":[]}"
      },
      "id": "df9e399b-efa5-4e33-b0ac-a7668a8ac2b3",
      "migrationVersion": {
        "visualization": "7.10.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [],
      "type": "visualization",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNjIsMV0="
    },
    {
      "attributes": {
        "description": "Source IP Addresses from dnp3.log",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"filter\":[]}"
        },
        "savedSearchRefName": "search_0",
        "title": "DNP3 - Source IP",
        "uiStateJSON": "{\"vis\":{\"params\":{\"sort\":{\"columnIndex\":null,\"direction\":null}}}}",
        "version": 1,
        "visState": "{\"title\":\"DNP3 - Source IP\",\"type\":\"table\",\"params\":{\"perPage\":10,\"showPartialRows\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showMetricsAtAllLevels\":false,\"percentageCol\":\"\",\"dimensions\":{\"metrics\":[{\"accessor\":1,\"format\":{\"id\":\"number\"},\"params\":{},\"label\":\"Count\",\"aggType\":\"count\"}],\"buckets\":[{\"accessor\":0,\"format\":{\"id\":\"terms\",\"params\":{\"id\":\"drilldown\",\"otherBucketLabel\":\"Other\",\"missingBucketLabel\":\"Missing\"}},\"params\":{},\"label\":\"IP Address\",\"aggType\":\"terms\"}]}},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"source.ip\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Source IP\"}}]}"
      },
      "id": "d34dd3b3-3861-4b9b-ba39-4ca7e15b3bdd",
      "migrationVersion": {
        "visualization": "7.10.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "cc135a63-3e30-4703-bc31-f7ac09c1d21a",
          "name": "search_0",
          "type": "search"
        }
      ],
      "type": "visualization",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNjMsMV0="
    },
    {
      "attributes": {
        "description": "Destination IP Addresses from dnp3.log",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"filter\":[]}"
        },
        "savedSearchRefName": "search_0",
        "title": "DNP3 - Destination IP",
        "uiStateJSON": "{\"vis\":{\"params\":{\"sort\":{\"columnIndex\":2,\"direction\":\"desc\"}}}}",
        "version": 1,
        "visState": "{\"title\":\"DNP3 - Destination IP\",\"type\":\"table\",\"params\":{\"perPage\":10,\"showPartialRows\":false,\"sort\":{\"columnIndex\":2,\"direction\":\"desc\"},\"showTotal\":false,\"totalFunc\":\"sum\",\"showMetricsAtAllLevels\":false,\"percentageCol\":\"\",\"dimensions\":{\"metrics\":[{\"accessor\":2,\"format\":{\"id\":\"number\"},\"params\":{},\"label\":\"Count\",\"aggType\":\"count\"}],\"buckets\":[{\"accessor\":0,\"format\":{\"id\":\"terms\",\"params\":{\"id\":\"drilldown\",\"otherBucketLabel\":\"Other\",\"missingBucketLabel\":\"Missing\"}},\"params\":{},\"label\":\"Port\",\"aggType\":\"terms\"}]}},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"destination.ip\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Destination IP\"}}]}"
      },
      "id": "131198e7-afc4-40be-bedd-2a3a3a2d511e",
      "migrationVersion": {
        "visualization": "7.10.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "cc135a63-3e30-4703-bc31-f7ac09c1d21a",
          "name": "search_0",
          "type": "search"
        }
      ],
      "type": "visualization",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNjQsMV0="
    },
    {
      "attributes": {
        "description": "DNP3 function in request packet from dnp3.log",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"lucene\"}}"
        },
        "savedSearchRefName": "search_0",
        "title": "DNP3 - Function Request",
        "uiStateJSON": "{\"vis\":{\"params\":{\"sort\":{\"columnIndex\":null,\"direction\":null}}}}",
        "version": 1,
        "visState": "{\"title\":\"DNP3 - Function Request\",\"type\":\"table\",\"params\":{\"perPage\":10,\"showPartialRows\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showMetricsAtAllLevels\":false,\"percentageCol\":\"\"},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"event.action\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Request\"}}]}"
      },
      "id": "46cd2e4c-ecfb-4fe9-ae51-28c2fecbffc0",
      "migrationVersion": {
        "visualization": "7.10.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "cc135a63-3e30-4703-bc31-f7ac09c1d21a",
          "name": "search_0",
          "type": "search"
        }
      ],
      "type": "visualization",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNjUsMV0="
    },
    {
      "attributes": {
        "description": "DNP3 function in reply packet from dnp3.log",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"filter\":[],\"query\":{\"query\":\"\",\"language\":\"lucene\"}}"
        },
        "savedSearchRefName": "search_0",
        "title": "DNP3 - Function Reply",
        "uiStateJSON": "{\"vis\":{\"params\":{\"sort\":{\"columnIndex\":null,\"direction\":null}}}}",
        "version": 1,
        "visState": "{\"title\":\"DNP3 - Function Reply\",\"type\":\"table\",\"params\":{\"perPage\":10,\"showPartialRows\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"showMetricsAtAllLevels\":false,\"percentageCol\":\"\"},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"zeek.dnp3.fc_reply\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Reply\"}}]}"
      },
      "id": "9422ff81-b007-4eef-aca1-1af16509ab8c",
      "migrationVersion": {
        "visualization": "7.10.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "cc135a63-3e30-4703-bc31-f7ac09c1d21a",
          "name": "search_0",
          "type": "search"
        }
      ],
      "type": "visualization",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNjYsMV0="
    },
    {
      "attributes": {
        "description": "Count of DNP3 logs including DNP3 Control and Objects logs",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"query\":{\"query\":\"event.dataset:*dnp3*\",\"language\":\"kuery\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"
        },
        "title": "DNP3 - Log Count",
        "uiStateJSON": "{}",
        "version": 1,
        "visState": "{\"title\":\"DNP3 - Log Count\",\"type\":\"metric\",\"params\":{\"addTooltip\":true,\"addLegend\":false,\"type\":\"metric\",\"metric\":{\"percentageMode\":false,\"useRanges\":false,\"colorSchema\":\"Green to Red\",\"metricColorMode\":\"None\",\"colorsRange\":[{\"from\":0,\"to\":10000}],\"labels\":{\"show\":true},\"invertColors\":false,\"style\":{\"bgFill\":\"#000\",\"bgColor\":false,\"labelColor\":false,\"subText\":\"\",\"fontSize\":36}}},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{\"customLabel\":\"Log Count\"}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"group\",\"params\":{\"field\":\"event.dataset\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Log Type\"}}]}"
      },
      "id": "34700240-cb66-11ea-b8b9-778c41cae039",
      "migrationVersion": {
        "visualization": "7.10.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "MALCOLM_NETWORK_INDEX_PATTERN_REPLACER",
          "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
          "type": "index-pattern"
        }
      ],
      "type": "visualization",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNjcsMV0="
    },
    {
      "attributes": {
        "description": "DNP3 logs over time",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"query\":{\"query\":\"event.dataset:*dnp3*\",\"language\":\"kuery\"},\"filter\":[],\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"
        },
        "title": "DNP3 - Logs Over Time",
        "uiStateJSON": "{\"vis\":{\"legendOpen\":true}}",
        "version": 1,
        "visState": "{\"title\":\"DNP3 - Logs Over Time\",\"type\":\"histogram\",\"params\":{\"type\":\"histogram\",\"grid\":{\"categoryLines\":false,\"style\":{\"color\":\"#eee\"}},\"categoryAxes\":[{\"id\":\"CategoryAxis-1\",\"type\":\"category\",\"position\":\"bottom\",\"show\":true,\"style\":{},\"scale\":{\"type\":\"linear\"},\"labels\":{\"show\":true,\"truncate\":100},\"title\":{}}],\"valueAxes\":[{\"id\":\"ValueAxis-1\",\"name\":\"LeftAxis-1\",\"type\":\"value\",\"position\":\"left\",\"show\":true,\"style\":{},\"scale\":{\"type\":\"square root\",\"mode\":\"normal\"},\"labels\":{\"show\":true,\"rotate\":0,\"filter\":false,\"truncate\":100},\"title\":{\"text\":\"\"}}],\"seriesParams\":[{\"show\":\"true\",\"type\":\"histogram\",\"mode\":\"stacked\",\"data\":{\"label\":\"Count\",\"id\":\"1\"},\"valueAxis\":\"ValueAxis-1\",\"drawLinesBetweenPoints\":true,\"showCircles\":true}],\"addTooltip\":true,\"addLegend\":true,\"legendPosition\":\"bottom\",\"times\":[],\"addTimeMarker\":false,\"labels\":{\"show\":false},\"thresholdLine\":{\"show\":false,\"value\":10,\"width\":1,\"style\":\"full\",\"color\":\"#E7664C\"},\"dimensions\":{\"x\":{\"accessor\":0,\"format\":{\"id\":\"date\",\"params\":{\"pattern\":\"YYYY\"}},\"params\":{\"date\":true,\"interval\":\"P365D\",\"intervalESValue\":365,\"intervalESUnit\":\"d\",\"format\":\"YYYY\",\"bounds\":{\"min\":\"1971-01-14T16:42:16.432Z\",\"max\":\"2021-01-14T16:42:16.432Z\"}},\"label\":\"MALCOLM_NETWORK_INDEX_TIME_FIELD_REPLACER per 365 days\",\"aggType\":\"date_histogram\"},\"y\":[{\"accessor\":2,\"format\":{\"id\":\"number\"},\"params\":{},\"label\":\"Count\",\"aggType\":\"count\"}],\"series\":[{\"accessor\":1,\"format\":{\"id\":\"terms\",\"params\":{\"id\":\"drilldown\",\"otherBucketLabel\":\"Other\",\"missingBucketLabel\":\"Missing\"}},\"params\":{},\"label\":\"Log Type\",\"aggType\":\"terms\"}]}},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{}},{\"id\":\"2\",\"enabled\":true,\"type\":\"date_histogram\",\"schema\":\"segment\",\"params\":{\"field\":\"MALCOLM_NETWORK_INDEX_TIME_FIELD_REPLACER\",\"useNormalizedEsInterval\":true,\"scaleMetricValues\":false,\"interval\":\"auto\",\"drop_partials\":false,\"min_doc_count\":1,\"extended_bounds\":{},\"customLabel\":\" \"}},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"group\",\"params\":{\"field\":\"event.dataset\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":5,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Log Type\"}}]}"
      },
      "id": "4f7c9990-cb66-11ea-b8b9-778c41cae039",
      "migrationVersion": {
        "visualization": "7.10.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "MALCOLM_NETWORK_INDEX_PATTERN_REPLACER",
          "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
          "type": "index-pattern"
        }
      ],
      "type": "visualization",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNjgsMV0="
    },
    {
      "attributes": {
        "description": "DNP3 Internal Indicators from dnp3.iin in dnp3.log",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{}"
        },
        "savedSearchRefName": "search_0",
        "title": "DNP3 - Internal Indicators Overview",
        "uiStateJSON": "{}",
        "version": 1,
        "visState": "{\"title\":\"DNP3 - Internal Indicators Overview\",\"type\":\"pie\",\"params\":{\"type\":\"pie\",\"addTooltip\":true,\"addLegend\":true,\"legendPosition\":\"bottom\",\"isDonut\":true,\"labels\":{\"show\":true,\"values\":true,\"last_level\":true,\"truncate\":100},\"dimensions\":{\"metric\":{\"accessor\":1,\"format\":{\"id\":\"number\"},\"params\":{},\"label\":\"Count\",\"aggType\":\"count\"},\"buckets\":[{\"accessor\":0,\"format\":{\"id\":\"terms\",\"params\":{\"id\":\"drilldown\",\"otherBucketLabel\":\"Other\",\"missingBucketLabel\":\"Missing\"}},\"params\":{},\"label\":\"Internal Indicators\",\"aggType\":\"terms\"}]}},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{\"customLabel\":\"\"}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"segment\",\"params\":{\"field\":\"zeek.dnp3.iin_flags\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":200,\"otherBucket\":false,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Internal Indicators\"}}]}"
      },
      "id": "9277d050-e33c-11ea-b05f-2302f75ab2c8",
      "migrationVersion": {
        "visualization": "7.10.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "cc135a63-3e30-4703-bc31-f7ac09c1d21a",
          "name": "search_0",
          "type": "search"
        }
      ],
      "type": "visualization",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNjksMV0="
    },
    {
      "attributes": {
        "description": "Overview of DNP3 objects from READ-RESPONSE messages in dnp3_objects.log",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{}"
        },
        "savedSearchRefName": "search_0",
        "title": "DNP3 - Objects Overview",
        "uiStateJSON": "{\"vis\":{\"params\":{\"sort\":{\"columnIndex\":3,\"direction\":null}}}}",
        "version": 1,
        "visState": "{\"title\":\"DNP3 - Objects Overview\",\"type\":\"table\",\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":3,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"percentageCol\":\"\",\"dimensions\":{\"metrics\":[{\"accessor\":4,\"format\":{\"id\":\"number\"},\"params\":{},\"label\":\"Count\",\"aggType\":\"count\"}],\"buckets\":[{\"accessor\":0,\"format\":{\"id\":\"terms\",\"params\":{\"id\":\"drilldown\",\"otherBucketLabel\":\"Other\",\"missingBucketLabel\":\"Missing\"}},\"params\":{},\"label\":\"IP Address\",\"aggType\":\"terms\"}]},\"row\":true},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{}},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"zeek.dnp3_objects.object_type\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Object Type\"}},{\"id\":\"8\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"zeek.dnp3_objects.object_count\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Object Count\"}},{\"id\":\"4\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"zeek.dnp3_objects.range_low\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"-\",\"missingBucket\":true,\"missingBucketLabel\":\"-\",\"customLabel\":\"Range Start\"}},{\"id\":\"5\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"zeek.dnp3_objects.range_high\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"-\",\"missingBucket\":true,\"missingBucketLabel\":\"-\",\"customLabel\":\"Range End\"}},{\"id\":\"7\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"split\",\"params\":{\"field\":\"destination.ip\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"IP Address\"}}]}"
      },
      "id": "fd7d74c0-e339-11ea-b05f-2302f75ab2c8",
      "migrationVersion": {
        "visualization": "7.10.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "cf32a680-cb65-11ea-b8b9-778c41cae039",
          "name": "search_0",
          "type": "search"
        }
      ],
      "type": "visualization",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNzAsMV0="
    },
    {
      "attributes": {
        "description": "Overview of DNP3 control functions from dnp3_control.log",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{}"
        },
        "savedSearchRefName": "search_0",
        "title": "DNP3 - Control Overview",
        "uiStateJSON": "{\"vis\":{\"params\":{\"sort\":{\"columnIndex\":5,\"direction\":null}}}}",
        "version": 1,
        "visState": "{\"title\":\"DNP3 - Control Overview\",\"type\":\"table\",\"params\":{\"perPage\":10,\"showPartialRows\":false,\"showMetricsAtAllLevels\":false,\"sort\":{\"columnIndex\":null,\"direction\":null},\"showTotal\":false,\"totalFunc\":\"sum\",\"percentageCol\":\"\",\"dimensions\":{\"metrics\":[{\"accessor\":5,\"format\":{\"id\":\"number\"},\"params\":{},\"label\":\"Count\",\"aggType\":\"count\"}],\"buckets\":[{\"accessor\":0,\"format\":{\"id\":\"terms\",\"params\":{\"id\":\"drilldown\",\"otherBucketLabel\":\"Other\",\"missingBucketLabel\":\"Missing\"}},\"params\":{},\"label\":\"Control Code\",\"aggType\":\"terms\"}]}},\"aggs\":[{\"id\":\"1\",\"enabled\":true,\"type\":\"count\",\"schema\":\"metric\",\"params\":{}},{\"id\":\"6\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"destination.ip\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"IP\"}},{\"id\":\"5\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"zeek.dnp3_control.index_number\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Index Number\"}},{\"id\":\"2\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"event.action\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Function\"}},{\"id\":\"7\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"zeek.dnp3_control.block_type\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Block Type\"}},{\"id\":\"3\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"zeek.dnp3_control.operation_type\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Operation Type\"}},{\"id\":\"4\",\"enabled\":true,\"type\":\"terms\",\"schema\":\"bucket\",\"params\":{\"field\":\"zeek.dnp3_control.trip_control_code\",\"orderBy\":\"1\",\"order\":\"desc\",\"size\":100,\"otherBucket\":true,\"otherBucketLabel\":\"Other\",\"missingBucket\":false,\"missingBucketLabel\":\"Missing\",\"customLabel\":\"Control Code\"}}]}"
      },
      "id": "63cebc10-e33b-11ea-b05f-2302f75ab2c8",
      "migrationVersion": {
        "visualization": "7.10.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "980f33d0-cb65-11ea-b8b9-778c41cae039",
          "name": "search_0",
          "type": "search"
        }
      ],
      "type": "visualization",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNzEsMV0="
    },
    {
      "attributes": {
        "description": "",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filter\":[]}"
        },
        "title": "DNP3 - Trends",
        "uiStateJSON": "{}",
        "version": 1,
        "visState": "{\"title\":\"DNP3 - Trends\",\"type\":\"vega\",\"aggs\":[],\"params\":{\"spec\":\"{\\n  /**  /**\\n    Version 1.0\\n    Authors:\\n      Nicholas Donovan\\n      \\n      Sara Hudson\\n    Thanks to:\\n      Sebastian Vera\\n      Mackenzie Zappe\\n      Melanie Pierce\\n      Jessica Rooney\\n    References:\\n      https://vega.github.io/vega/docs/\\n      https://vega.github.io/vega/examples/overview-plus-detail/\\n      https://vega.github.io/vega/examples/interactive-legend/\\n      https://vega.github.io/vega/examples/table-scrollbar/\\n    Commit:\\n      Corresponds to 8ca1225 in SMILE-Analytics/squiggles/release\\n\\n    To Do\\n      Allow drag from main graph\\n      Allow IP Selection text filter box thing (on hold until I can set a signal bind position)\\n  **/\\n\\n  \\\"$schema\\\": \\\"https://vega.github.io/schema/vega/v5.json\\\",\\n  ##  --------------------------------------------------------------------------------------------------------------------------\\n  ##  SECTION 0: Config --------------------------------------------------------------------------------------------------------\\n  ##  Define Specification constants like multiple instruction positioning\\n  ##  - arguments set in Config WILL be overwritten if redefined later in specification\\n  \\\"config\\\": {\\n    \\\"signals\\\": [\\n      {\\n        \\\"name\\\": \\\"fontScale\\\",\\n        \\\"update\\\": \\\"clamp(min(width / 1920, height / 1080), 0.7, 1.2)\\\"\\n      },\\n      {\\n        \\\"name\\\": \\\"paddingScale\\\",\\n        \\\"update\\\": \\\"clamp(min(width / 1920, height / 1080), 0.5, 2)\\\"\\n      },\\n      {\\n        \\\"name\\\": \\\"labelFontSize\\\",\\n        \\\"init\\\": \\\"16 * fontScale\\\"\\n      },\\n      {\\n        \\\"name\\\": \\\"titleFontSize\\\",\\n        \\\"init\\\": \\\"18 * fontScale\\\"\\n      },\\n      {\\n        \\\"name\\\": \\\"upperHeight\\\",\\n        \\\"update\\\": \\\"height * 0.6\\\"\\n      },\\n      {\\n        \\\"name\\\": \\\"lowerHeight\\\",\\n        \\\"update\\\": \\\"height * 0.1\\\"\\n      },\\n      {\\n        \\\"name\\\": \\\"graphWidth\\\",\\n        \\\"update\\\": \\\"width * 0.80\\\"\\n      },\\n      {\\n        \\\"name\\\": \\\"overviewGraphY\\\",\\n        \\\"update\\\": \\\"upperHeight + (200 * paddingScale)\\\"\\n      },\\n      {\\n        \\\"name\\\": \\\"ipSelectX\\\",\\n        \\\"init\\\": \\\"graphWidth + (40 * paddingScale)\\\"\\n      },\\n      {\\n        \\\"name\\\": \\\"interpolate\\\",\\n        \\\"value\\\": \\\"linear\\\"\\n      }\\n    ],\\n    \\\"axis\\\": {\\n      \\\"titleFontSize\\\": {\\n        \\\"signal\\\": \\\"titleFontSize\\\"\\n      },\\n      \\\"titlePadding\\\": {\\n        \\\"signal\\\": \\\"25 * paddingScale\\\"\\n      },\\n      \\\"labelFontSize\\\": {\\n        \\\"signal\\\": \\\"labelFontSize\\\"\\n      },\\n      \\\"labelFontWeight\\\": \\\"bold\\\",\\n      \\\"tickWidth\\\": 3\\n    },\\n    \\\"title\\\": {\\n      \\\"fontSize\\\": {\\n        \\\"signal\\\": \\\"titleFontSize\\\"\\n      }\\n    },\\n    \\\"legend\\\": {\\n      \\\"orient\\\": \\\"top-left\\\",\\n      \\\"titleFontSize\\\": {\\n        \\\"signal\\\": \\\"titleFontSize * 0.9\\\"\\n      },\\n      \\\"labelFontSize\\\": {\\n        \\\"signal\\\": \\\"labelFontSize\\\"\\n      },\\n      \\\"symbolSize\\\": 128,\\n      \\\"symbolStrokeWidth\\\": 2,\\n      \\\"padding\\\": {\\n        \\\"signal\\\": \\\"10 * paddingScale\\\"\\n      }\\n    },\\n    \\\"text\\\": {\\n      \\\"fontSize\\\": {\\n        \\\"signal\\\": \\\"labelFontSize * 0.9\\\"\\n      },\\n      \\\"baseline\\\": \\\"middle\\\"\\n    },\\n    \\\"rule\\\": {\\n      \\\"strokeWidth\\\": 0.2,\\n      \\\"stroke\\\": \\\"firebrick\\\"\\n    },\\n    \\\"rect\\\": {\\n      \\\"fill\\\": \\\"darkgrey\\\"\\n    }\\n  },\\n  ##  ---------------------------------------------------------------------------------------------------------------------------\\n  ##  SECTION 1: Signals --------------------------------------------------------------------------------------------------------\\n  ##  - Define dynamic variables (Signals) that can be updated at any point during the specification\\n  \\\"signals\\\": [\\n    /** For main and overview graphs **/\\n    {\\n      \\\"name\\\": \\\"xDetailZoom\\\"\\n    },\\n    // updated in overview marks group\\n    {\\n      \\\"name\\\": \\\"yDetailZoom\\\"\\n    },\\n    // updated in overview marks group\\n\\n    // Holds the identification for a hovered dot tooltip\\n    {\\n      \\\"name\\\": \\\"hoveredTimestamp\\\",\\n      \\\"value\\\": [\\n        null,\\n        null\\n      ],\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": \\\"@infoDot:mouseover\\\",\\n          \\\"update\\\": \\\"[datum.addr, datum.timestamp]\\\"\\n        },\\n        {\\n          \\\"events\\\": \\\"@infoDot:mouseout\\\",\\n          \\\"update\\\": \\\"[null, null]\\\"\\n        }\\n      ]\\n    },\\n    /** Legend **/\\n    // Clear the legend when clicking but not interacting with another event\\n    {\\n      \\\"name\\\": \\\"clear\\\",\\n      \\\"value\\\": true,\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": \\\"pointerup[!event.item]\\\",\\n          \\\"update\\\": \\\"true\\\",\\n          \\\"force\\\": true\\n        }\\n      ]\\n    },\\n    // Allow multi-select while holding shift\\n    {\\n      \\\"name\\\": \\\"shift\\\",\\n      \\\"value\\\": false,\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": \\\"@legendSymbol:pointerdown, @legendSymbol:pointerup || @legendLabel:pointerdown, @legendLabel:pointerup\\\",\\n          \\\"update\\\": \\\"event.shiftKey\\\",\\n          \\\"force\\\": true\\n        }\\n      ]\\n    },\\n    // Add clicked items to selected data set\\n    {\\n      \\\"name\\\": \\\"clicked\\\",\\n      \\\"value\\\": null,\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": \\\"@legendSymbol:pointerdown, @legendSymbol:pointerup || @legendLabel:pointerdown, @legendLabel:pointerup\\\",\\n          \\\"update\\\": \\\"{value: datum.value}\\\",\\n          \\\"force\\\": true\\n        },\\n        {\\n          \\\"events\\\": \\\"@detailLine:pointerdown, @detailLine.pointerup\\\",\\n          \\\"update\\\": \\\"{value: datum.addr}\\\",\\n          \\\"force\\\": true\\n        }\\n      ]\\n    },\\n    /** Selection Tables **/\\n    {\\n      \\\"name\\\": \\\"ips\\\",\\n      \\\"update\\\": \\\"length(data('destIps')) ? pluck(data('destIps'), 'destIp') : warn('No IP addresses found.')\\\"\\n    },\\n    {\\n      \\\"name\\\": \\\"rowHeight\\\",\\n      \\\"value\\\": 30\\n    },\\n    {\\n      \\\"name\\\": \\\"minIps\\\",\\n      \\\"value\\\": 10\\n    },\\n    /** IP Selection **/\\n    {\\n      \\\"name\\\": \\\"ipsToDisplay\\\",\\n      \\\"update\\\": \\\"min(minIps, length(data('destIps')))\\\"\\n    },\\n    {\\n      \\\"name\\\": \\\"ipsScrollAreaHeight\\\",\\n      \\\"update\\\": \\\"rowHeight * ipsToDisplay\\\"\\n    },\\n    {\\n      \\\"name\\\": \\\"ipsScrollPositionMax\\\",\\n      \\\"update\\\": \\\"length(data('destIps')) - ipsToDisplay + 1\\\"\\n    },\\n    {\\n      \\\"name\\\": \\\"ipsScrollBarHeight\\\",\\n      \\\"init\\\": \\\"clamp((rowHeight * ipsToDisplay) * ipsToDisplay / length(data('destIps')), 30, 600)\\\"\\n    },\\n    // IP that was selected in the table\\n    {\\n      \\\"name\\\": \\\"selectedIp\\\",\\n      \\\"init\\\": \\\"ips[0]\\\",\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": \\\"@destIps-rect-cell:pointerdown, @destIps-rect-cell:pointerup || @destIps-text-content:pointerdown, @destIps-text-content:pointerup\\\",\\n          \\\"update\\\": \\\"datum.destIp\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"ipsScrollbarMouseDragY\\\",\\n      \\\"init\\\": \\\"0\\\",\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": \\\"[@rect-scrollbar:pointerdown, window:pointerup] > window:pointermove\\\",\\n          \\\"update\\\": \\\"clamp(y(), 1, ipsScrollAreaHeight)\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"ipsScrollPosition\\\",\\n      \\\"value\\\": 1,\\n      \\\"on\\\": [\\n        {\\n          \\\"events\\\": [\\n            {\\n              \\\"markname\\\": \\\"destIps-rect-cell\\\",\\n              \\\"type\\\": \\\"wheel\\\",\\n              \\\"consume\\\": true\\n            },\\n            {\\n              \\\"markname\\\": \\\"destIps-text-content\\\",\\n              \\\"type\\\": \\\"wheel\\\",\\n              \\\"consume\\\": true\\n            }\\n          ],\\n          \\\"update\\\": \\\"clamp(round(ipsScrollPosition + event.deltaY / abs(event.deltaY) * pow(1.0001, event.deltaY * pow(16, event.deltaMode)), 0), 1, ipsScrollPositionMax)\\\"\\n        },\\n        {\\n          \\\"events\\\": \\\"[@rect-scrollbar:pointerdown, window:pointerup] > window:pointermove\\\",\\n          \\\"update\\\": \\\"clamp(round(invert('ipsScaleScrollBarY', ipsScrollbarMouseDragY), 0), 1, ipsScrollPositionMax)\\\"\\n        }\\n      ]\\n    },\\n\\n    {\\n      \\\"name\\\": \\\"potentialDate\\\",\\n      \\\"value\\\": null,\\n      \\\"update\\\": \\\"timeParse(pluck(data('ipData'), 'value')[0], '%-m/%-d/%Y')\\\"\\n      // pluck(data('destIps'), 'destIp')\\n    },\\n    {\\n      \\\"name\\\": \\\"isDate\\\",\\n      \\\"value\\\": false,\\n      \\\"update\\\": \\\"potentialDate == null ? false : true\\\"\\n    },\\n    {\\n      \\\"name\\\": \\\"markDataset_signal\\\",\\n      \\\"update\\\": \\\"data('markDataset') ? pluck(data('markDataset'), 'dataset') : ['']\\\"\\n    },\\n    {\\n      \\\"name\\\": \\\"markNames\\\",\\n      \\\"value\\\": {\\n        \\\"bacnet_property\\\": \\\"BACnet - Analog/Binary IO\\\"\\n      }\\n    },\\n    {\\n      \\\"name\\\": \\\"markDatasetName\\\",\\n      \\\"update\\\": \\\"length(markDataset_signal) > 1 ? markDataset_signal : markNames[markDataset_signal[0]] ? markNames[markDataset_signal[0]] : markDataset_signal\\\"\\n    }\\n  ],\\n  ## --------------------------------------------------------------------------------------------------------------------------\\n  ##  SECTION 2: DATA --------------------------------------------------------------------------------------------------------\\n  ##  Define datasets and data normalization to be worked with in schema\\n  \\\"data\\\": [\\n    {\\n      \\\"name\\\": \\\"dnp3Raw\\\",\\n      \\\"url\\\": {\\n        \\\"index\\\": \\\"MALCOLM_NETWORK_INDEX_PATTERN_REPLACER\\\",\\n        \\\"body\\\": {\\n          \\\"query\\\": {\\n            \\\"bool\\\": {\\n              \\\"must\\\": [\\n                {\\n                  \\\"match\\\": {\\n                    \\\"event.dataset\\\": \\\"dnp3_control\\\"\\n                  }\\n                }\\n                \\\"%dashboard_context-must_clause%\\\"\\n              ],\\n              \\\"must_not\\\": [\\n                \\\"%dashboard_context-must_not_clause%\\\"\\n              ],\\n              \\\"filter\\\": [\\n                \\\"%dashboard_context-filter_clause%\\\",\\n                {\\n                  \\\"range\\\": {\\n                    \\\"MALCOLM_OTHER_INDEX_TIME_FIELD_REPLACER\\\": {\\n                          \\\"%timefilter%\\\": true\\n                      }\\n                    }\\n                  },\\n                {\\n                  \\\"exists\\\": {\\n                    \\\"field\\\": \\\"event.action\\\"\\n                  }\\n                },\\n                {\\n                  \\\"terms\\\":{\\n                  \\\"zeek.dnp3_control.function_code\\\": [\\n                    \\\"SELECT\\\",\\n                    \\\"OPERATE\\\",\\n                    \\\"DIRECT_OPERATE\\\",\\n                    \\\"DIRECT_OPERATE_NR\\\"\\n                  ]\\n                  }\\n                }\\n              ],\\n            }\\n          },\\n          \\\"size\\\": 10000,\\n          \\\"sort\\\": [\\n            {\\n              \\\"timestamp\\\": {\\n                \\\"order\\\": \\\"asc\\\"\\n              }\\n            }\\n          ],\\n          //These are the fields we retrieve\\n          \\\"_source\\\": [\\n            \\\"event.dataset\\\",\\n            \\\"event.id\\\",\\n            \\\"event.action\\\",\\n            \\\"timestamp\\\",\\n            \\\"destination.ip\\\",\\n            \\\"destination.port\\\",\\n            \\\"zeek.dnp3_control.execute_count\\\",\\n            \\\"zeek.dnp3_control.index_number\\\",\\n            \\\"zeek.dnp3_control.on_time\\\",\\n            \\\"zeek.dnp3_control.off_time\\\",\\n         ]\\n        }\\n      },\\n      \\\"format\\\": {\\n        \\\"property\\\": \\\"hits.hits\\\"\\n      },\\n      //Save the needed fieldnames as something more usable and remove the rest of the data\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"project\\\",\\n          \\\"fields\\\": [\\n            \\\"_source.event.dataset\\\",\\n            \\\"_source.event.id\\\",\\n            \\\"_source.event.action\\\"\\n            \\\"_source.timestamp\\\",\\n            \\\"_source.destination.ip\\\",\\n            \\\"_source.destination.port\\\",\\n            \\\"_source.zeek.dnp3_control.execute_count\\\",\\n            \\\"_source.zeek.dnp3_control.index_number\\\",\\n            \\\"_source.zeek.dnp3_control.on_time\\\",\\n            \\\"_source.zeek.dnp3_control.off_time\\\",\\n          ],\\n          \\\"as\\\": [\\n            \\\"dataset\\\",\\n            \\\"id\\\",\\n            \\\"pduService\\\"\\n            \\\"timestamp\\\",\\n            \\\"destIp\\\",\\n            \\\"destPort\\\",\\n            \\\"execute_count\\\",\\n            \\\"instanceNumber\\\",\\n            \\\"on_time\\\",\\n            \\\"off_time\\\",\\n\\n          ]\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"datum.on_time - datum.off_time\\\",\\n          \\\"as\\\": \\\"value\\\"       // duration\\n        }\\n      ]\\n\\n    },\\n    {\\n      \\\"name\\\": \\\"ipData\\\",\\n      \\\"source\\\": \\\"dnp3Raw\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"filter\\\",\\n          \\\"expr\\\": \\\"datum.destIp === selectedIp\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"dnp3Data\\\",\\n      \\\"source\\\": \\\"ipData\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"toNumber(datum.instanceNumber)\\\",\\n          \\\"as\\\": \\\"instanceNumber\\\"\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"isDate ? time(potentialDate) : datum.value\\\",\\n          \\\"as\\\": \\\"value\\\"\\n        },\\n        // Save only required fields and trash the rest\\n        {\\n          \\\"type\\\": \\\"project\\\",\\n          \\\"fields\\\": [\\n            \\\"dataset\\\",\\n            \\\"id\\\",\\n            \\\"timestamp\\\",\\n            \\\"destIp\\\",\\n            \\\"destPort\\\",\\n            \\\"pduService\\\",\\n            \\\"execute_count\\\",\\n            \\\"instanceNumber\\\",\\n            \\\"value\\\",\\n          ]\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"markData\\\",\\n      \\\"source\\\": [\\n        \\\"dnp3Data\\\",\\n      ],\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"datum.pduService[0]\\\",\\n          \\\"as\\\": \\\"func\\\"\\n        },\\n        {\\n          \\\"type\\\": \\\"formula\\\",\\n          \\\"expr\\\": \\\"datum.instanceNumber\\\",\\n          \\\"as\\\": \\\"addr\\\"\\n        },\\n        {\\n          \\\"type\\\": \\\"project\\\",\\n          \\\"fields\\\": [\\n            \\\"dataset\\\",\\n            \\\"id\\\",\\n            \\\"timestamp\\\",\\n            \\\"destIp\\\",\\n            \\\"destPort\\\",\\n            \\\"func\\\",\\n            \\\"execute_count\\\",\\n            \\\"addr\\\",\\n            \\\"value\\\",\\n          ]\\n        }\\n      ]\\n    },\\n    // Group unique IPs\\n    {\\n      \\\"name\\\": \\\"destIps\\\",\\n      \\\"source\\\": [\\n        \\\"dnp3Raw\\\"\\n      ],\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"aggregate\\\",\\n          \\\"groupby\\\": [\\n            \\\"destIp\\\"\\n          ]\\n        },\\n        {\\n          \\\"type\\\": \\\"collect\\\",\\n          \\\"sort\\\": {\\n            \\\"field\\\": \\\"destIp\\\"\\n          }\\n        }\\n      ]\\n    },\\n    // Hack for the table, filters only the position in the table\\n    {\\n      \\\"name\\\": \\\"ipSlice\\\",\\n      \\\"source\\\": \\\"destIps\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"filter\\\",\\n          \\\"expr\\\": \\\"(indexof(ips, datum.destIp) + 1 >= ipsScrollPosition) && (indexof(ips, datum.destIp) + 1 < (ipsScrollPosition + ipsToDisplay))\\\"\\n        }\\n      ]\\n    },\\n    // Holds selected legend items\\n    {\\n      \\\"name\\\": \\\"selected\\\",\\n      \\\"on\\\": [\\n        {\\n          \\\"trigger\\\": \\\"clear\\\",\\n          \\\"remove\\\": true\\n        },\\n        {\\n          \\\"trigger\\\": \\\"!shift\\\",\\n          \\\"remove\\\": true\\n        },\\n        {\\n          \\\"trigger\\\": \\\"!shift && clicked\\\",\\n          \\\"insert\\\": \\\"clicked\\\"\\n        },\\n        {\\n          \\\"trigger\\\": \\\"shift && clicked\\\",\\n          \\\"toggle\\\": \\\"clicked\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"name\\\": \\\"markDataset\\\",\\n      \\\"source\\\": \\\"markData\\\",\\n      \\\"transform\\\": [\\n        {\\n          \\\"type\\\": \\\"aggregate\\\",\\n          \\\"groupby\\\": [\\\"dataset\\\"],\\n        }\\n      ]\\n    }\\n  ],\\n  ## --------------------------------------------------------------------------------------------------------------------------\\n  ##  SECTION 3: Scales -------------------------------------------------------------------------------------------------------\\n  ##  Maps data values to either categorical data or numerical data to change the way the data presents visually\\n   \\n  \\\"scales\\\": [\\n    {\\n      \\\"name\\\": \\\"color\\\",\\n      \\\"type\\\": \\\"ordinal\\\",\\n      \\\"domain\\\": {\\n        \\\"data\\\": \\\"markData\\\",\\n        \\\"field\\\": \\\"addr\\\",\\n        \\\"sort\\\": true\\n      },\\n      \\\"range\\\": {\\n        \\\"scheme\\\": \\\"category20\\\"\\n      }\\n    },\\n    {\\n      \\\"name\\\": \\\"nodeSize\\\",\\n      \\\"type\\\": \\\"linear\\\",\\n      \\\"domain\\\": {\\n        \\\"data\\\": \\\"dnp3Raw\\\",\\n        \\\"field\\\": \\\"execute_count\\\"\\n      },\\n      \\\"range\\\": [100,300],\\n      \\\"zero\\\": true\\n    },\\n    {\\n      \\\"name\\\": \\\"nodeShape\\\",\\n      \\\"type\\\": \\\"ordinal\\\",\\n      \\\"domain\\\": [\\\"OPERATE:unknown-f:unknown-3\\\", \\\"OPERATE\\\", \\\"OPERATE:Pulse On\\\", \\\"OPERATE:Pulse On:Trip\\\", \\\"OPERATE:Pulse Off:Close\\\", \\\"OPERATE:Latch On\\\", \\\"RESPONSE:Latch On\\\", \\\"RESPONSE:Pulse On:Trip\\\", \\\"RESPONSE:Pulse Off:Close\\\", \\\"SELECT:Latch On\\\", \\\"SELECT:Pulse On:Trip\\\", \\\"SELECT:Pulse Off:Close\\\", \\\"DIRECT_OPERATE:Latch On\\\", \\\"DIRECT_OPERATE_NR:Latch On\\\", \\\"DIRECT_OPERATE:Pulse Off\\\"],\\n      \\\"range\\\": [\\\"cross\\\", \\\"square\\\", \\\"square\\\", \\\"square\\\", \\\"square\\\", \\\"square\\\", \\\"triangle\\\", \\\"triangle\\\", \\\"triangle\\\", \\\"triangle-down\\\", \\\"triangle-down\\\", \\\"triangle-down\\\", \\\"diamond\\\", \\\"diamond\\\", \\\"diamond\\\"]\\n    },\\n    {\\n      \\\"name\\\": \\\"ipsScaleScrollBarY\\\",\\n      \\\"type\\\": \\\"linear\\\",\\n      \\\"domain\\\": [\\n        1,\\n        {\\n          \\\"signal\\\": \\\"ipsScrollPositionMax\\\"\\n        }\\n      ],\\n      \\\"range\\\": [\\n        0,\\n        {\\n          \\\"signal\\\": \\\"rowHeight * ipsToDisplay - ipsScrollBarHeight - 1\\\"\\n        }\\n      ]\\n    },\\n  ],\\n  ## --------------------------------------------------------------------------------------------------------------------------\\n  ##  SECTION 5: Marks --------------------------------------------------------------------------------------------------------\\n  ##  Determines how the data visually appears in the visualization\\n  /****** START MAIN GRAPH MARKS ******/\\n  \\\"marks\\\": [\\n    {\\n      \\\"type\\\": \\\"group\\\",\\n      \\\"name\\\": \\\"detail\\\",\\n      \\\"encode\\\": {\\n        \\\"enter\\\": {\\n          \\\"height\\\": {\\n            \\\"signal\\\": \\\"upperHeight\\\"\\n          },\\n          \\\"width\\\": {\\n            \\\"signal\\\": \\\"graphWidth\\\"\\n          }\\n        }\\n      },\\n      \\\"title\\\": {\\n        \\\"text\\\": {\\n          \\\"signal\\\": \\\"'Detailed Graph: ' + markDatasetName\\\"\\n        },\\n        \\\"orient\\\": \\\"top\\\",\\n        \\\"align\\\": \\\"center\\\"\\n      },\\n      \\\"scales\\\": [\\n        {\\n          \\\"name\\\": \\\"xScale\\\",\\n          \\\"type\\\": \\\"time\\\",\\n          \\\"domain\\\": {\\n            \\\"data\\\": \\\"markData\\\",\\n            \\\"field\\\": \\\"timestamp\\\"\\n          },\\n          \\\"domainRaw\\\": {\\n            \\\"signal\\\": \\\"xDetailZoom\\\"\\n          },\\n          \\\"range\\\": [\\n            0,\\n            {\\n              \\\"signal\\\": \\\"graphWidth\\\"\\n            }\\n          ],\\n          \\\"nice\\\": true\\n        },\\n        {\\n          \\\"name\\\": \\\"yScale\\\",\\n          \\\"type\\\": \\\"symlog\\\",\\n          \\\"domain\\\": {\\n            \\\"data\\\": \\\"markData\\\",\\n            \\\"field\\\": \\\"value\\\"\\n          },\\n          \\\"domainRaw\\\": {\\n            \\\"signal\\\": \\\"yDetailZoom\\\"\\n          },\\n          \\\"range\\\": [\\n            {\\n              \\\"signal\\\": \\\"upperHeight - 10\\\"\\n            },\\n            10\\n          ],\\n          \\\"nice\\\": true\\n        }\\n      ],\\n      \\\"axes\\\": [\\n        {\\n          \\\"scale\\\": \\\"xScale\\\",\\n          \\\"title\\\": \\\"Date & Time\\\",\\n          \\\"orient\\\": \\\"bottom\\\",\\n          \\\"format\\\": \\\"%m-%d-%Y %H:%M:%S\\\",\\n          \\\"formatType\\\": \\\"time\\\",\\n          \\\"labelAngle\\\": -30,\\n          \\\"labelPadding\\\": {\\n            \\\"signal\\\": \\\"50 * paddingScale\\\"\\n          },\\n          \\\"labelFontSize\\\": {\\n            \\\"signal\\\": \\\"labelFontSize * 0.95\\\"\\n          },\\n          \\\"grid\\\": true\\n        },\\n        {\\n          \\\"scale\\\": \\\"yScale\\\",\\n          \\\"title\\\": \\\"Values\\\",\\n          \\\"orient\\\": \\\"left\\\",\\n          // \\\"labelSeparation\\\": 100\\n          \\\"labelOverlap\\\": true\\n        }\\n      ],\\n      \\\"legends\\\": [\\n        {\\n          \\\"title\\\": \\\"PLC Address\\\",\\n          \\\"stroke\\\": \\\"color\\\",\\n          \\\"fill\\\": \\\"color\\\",\\n          \\\"encode\\\": {\\n            \\\"symbols\\\": {\\n              \\\"name\\\": \\\"legendSymbol\\\",\\n              \\\"interactive\\\": true,\\n              \\\"update\\\": {\\n                \\\"opacity\\\": [\\n                  {\\n                    \\\"test\\\": \\\"!length(data('selected')) || indata('selected', 'value', datum.value)\\\",\\n                    \\\"value\\\": 0.7\\n                  },\\n                  {\\n                    \\\"value\\\": 0.15\\n                  }\\n                ],\\n                \\\"cursor\\\": {\\n                  \\\"value\\\": \\\"pointer\\\"\\n                }\\n              }\\n            },\\n            \\\"labels\\\": {\\n              \\\"name\\\": \\\"legendLabel\\\",\\n              \\\"interactive\\\": true,\\n              \\\"update\\\": {\\n                \\\"opacity\\\": [\\n                  {\\n                    \\\"test\\\": \\\"!length(data('selected')) || indata('selected', 'value', datum.value)\\\",\\n                    \\\"value\\\": 1\\n                  },\\n                  {\\n                    \\\"value\\\": 0.25\\n                  }\\n                ],\\n                \\\"text\\\": {\\n                  \\\"signal\\\": \\\"'Address ' + datum.label\\\"\\n                },\\n                \\\"cursor\\\": {\\n                  \\\"value\\\": \\\"pointer\\\"\\n                }\\n              }\\n            }\\n          }\\n        }\\n      ],\\n      \\\"marks\\\": [\\n        {\\n          \\\"type\\\": \\\"group\\\",\\n          \\\"clip\\\": true,\\n          \\\"encode\\\": {\\n            \\\"enter\\\": {\\n              \\\"height\\\": {\\n                \\\"field\\\": {\\n                  \\\"group\\\": \\\"height\\\"\\n                }\\n              },\\n              \\\"width\\\": {\\n                \\\"field\\\": {\\n                  \\\"group\\\": \\\"width\\\"\\n                }\\n              }\\n            }\\n          },\\n          \\\"from\\\": {\\n            // Separate data points by addr for graphing\\n            \\\"facet\\\": {\\n              \\\"name\\\": \\\"series\\\",\\n              \\\"data\\\": \\\"markData\\\",\\n              \\\"groupby\\\": \\\"addr\\\"\\n            }\\n          },\\n          \\\"marks\\\": [\\n            {\\n              \\\"type\\\": \\\"line\\\",\\n              \\\"name\\\": \\\"detailLine\\\",\\n              \\\"from\\\": {\\n                \\\"data\\\": \\\"series\\\"\\n              },\\n              \\\"interactive\\\": true,\\n              \\\"encode\\\": {\\n                \\\"update\\\": {\\n                  \\\"x\\\": {\\n                    \\\"scale\\\": \\\"xScale\\\",\\n                    \\\"field\\\": \\\"timestamp\\\"\\n                  },\\n                  \\\"y\\\": {\\n                    \\\"scale\\\": \\\"yScale\\\",\\n                    \\\"field\\\": \\\"value\\\"\\n                  },\\n                  \\\"interpolate\\\": {\\n                    \\\"signal\\\": \\\"interpolate\\\"\\n                  },\\n                  \\\"opacity\\\": [\\n                    {\\n                      \\\"test\\\": \\\"!length(data('selected')) || indata('selected', 'value', datum.addr)\\\",\\n                      \\\"value\\\": 1\\n                    },\\n                    {\\n                      \\\"value\\\": 0.05\\n                    }\\n                  ],\\n                  \\\"stroke\\\": [\\n                    {\\n                      \\\"test\\\": \\\"!length(data('selected')) || indata('selected', 'value', datum.addr)\\\",\\n                      \\\"scale\\\": \\\"color\\\",\\n                      \\\"field\\\": \\\"addr\\\"\\n                    },\\n                    {\\n                      \\\"value\\\": \\\"#ccc\\\"\\n                    }\\n                  ],\\n                  \\\"cursor\\\": {\\n                    \\\"value\\\": \\\"pointer\\\"\\n                  }\\n                }\\n              }\\n            },\\n            {\\n              // TODO different symbol for registers vs coils\\n              \\\"type\\\": \\\"symbol\\\",\\n              \\\"name\\\": \\\"infoDot\\\",\\n              \\\"from\\\": {\\n                \\\"data\\\": \\\"series\\\"\\n              },\\n              \\\"encode\\\": {\\n                \\\"update\\\": {\\n                  \\\"x\\\": {\\n                    \\\"scale\\\": \\\"xScale\\\",\\n                    \\\"field\\\": \\\"timestamp\\\"\\n                  },\\n                  \\\"y\\\": {\\n                    \\\"scale\\\": \\\"yScale\\\",\\n                    \\\"field\\\": \\\"value\\\"\\n                  },\\n                  \\\"interpolate\\\": {\\n                    \\\"signal\\\": \\\"interpolate\\\"\\n                  },\\n                  \\\"tooltip\\\": {\\n                    \\\"signal\\\": \\\"{ 'Dataset': datum.dataset, 'PLC IP:Port': datum.destIp + ':' + datum.destPort, 'Address': datum.addr, 'Function': datum.func, 'Execute Count': datum.execute_count, 'Duration (ms)': datum.value,  'Date/Time': timeFormat(datum.timestamp, '%b %d, %Y') + ' ' + timeFormat(datum.timestamp, '%H:%M:%S:%L %Z'), 'Event ID': join(datum.id) }\\\"\\n                  },\\n                  \\\"opacity\\\": [\\n                    {\\n                      \\\"test\\\": \\\"!length(data('selected')) || indata('selected', 'value', datum.addr)\\\",\\n                      \\\"value\\\": 1\\n                    },\\n                    {\\n                      \\\"value\\\": 0.25\\n                    }\\n                  ],\\n                  \\\"fill\\\": [\\n                    {\\n                      \\\"test\\\": \\\"!length(data('selected')) || indata('selected', 'value', datum.addr)\\\",\\n                      \\\"signal\\\": \\\"(datum.addr === hoveredTimestamp[0] && datum.timestamp === hoveredTimestamp[1]) ? 'orange' : scale('color', datum.addr)\\\"\\n                    }\\n                  ],\\n                  \\\"size\\\": [ \\n                    {\\n                      \\\"test\\\": \\\"datum.execute_count === '0'\\\",\\n                      \\\"value\\\": [50]\\n                    },\\n                    {\\n                      \\\"scale\\\": \\\"nodeSize\\\", \\\"field\\\": \\\"execute_count\\\"\\n                    } \\n                  ],\\n                  \\\"shape\\\": {\\\"scale\\\": \\\"nodeShape\\\", \\\"field\\\": \\\"func\\\"}\\n                }\\n              }\\n            }\\n          ]\\n        }\\n      ]\\n    },\\n    /****** START OVERVIEW GRAPH ******/\\n    {\\n      \\\"type\\\": \\\"group\\\",\\n      \\\"name\\\": \\\"overview\\\",\\n      \\\"encode\\\": {\\n        \\\"enter\\\": {\\n          \\\"y\\\": {\\n            \\\"signal\\\": \\\"overviewGraphY\\\"\\n          },\\n          \\\"height\\\": {\\n            \\\"signal\\\": \\\"lowerHeight\\\"\\n          },\\n          \\\"width\\\": {\\n            \\\"signal\\\": \\\"graphWidth\\\"\\n          },\\n          \\\"fill\\\": {\\n            \\\"value\\\": \\\"transparent\\\"\\n          },\\n          \\\"cursor\\\": {\\n            \\\"value\\\": \\\"crosshair\\\"\\n          }\\n        }\\n      },\\n      \\\"title\\\": {\\n        \\\"text\\\": \\\"Overview Selection Graph\\\",\\n        \\\"orient\\\": \\\"bottom\\\",\\n        \\\"align\\\": \\\"center\\\"\\n      },\\n      \\\"signals\\\": [\\n        // Holds click-drag coordinates\\n        {\\n          \\\"name\\\": \\\"brush\\\",\\n          \\\"value\\\": [\\n            0,\\n            0\\n          ],\\n          \\\"on\\\": [\\n            {\\n              \\\"events\\\": \\\"@overview:pointerdown\\\",\\n              \\\"update\\\": \\\"[[x(), x()], [y('overview'), y('overview')]]\\\"\\n            },\\n            {\\n              \\\"events\\\": \\\"[@overview:pointerdown, window:pointerup] > @overview:pointermove!\\\",\\n              \\\"update\\\": \\\"[[brush[0][0], clamp(x(), 0, graphWidth)], [brush[1][0], clamp(y('overview'), -5, lowerHeight + 10)]]\\\"\\n              // + 5 allows the selection to go slightly lower than the minimum value\\n            },\\n            {\\n              \\\"events\\\": {\\n                \\\"signal\\\": \\\"delta\\\"\\n              },\\n              \\\"update\\\": \\\"[clampRange([anchor[0][0] + delta[0], anchor[0][1] + delta[0]], 0, graphWidth), clampRange([anchor[1][0] + delta[1], anchor[1][1] + delta[1]], 0, lowerHeight + 5)]\\\"\\n            }\\n          ]\\n        },\\n        {\\n          \\\"name\\\": \\\"anchor\\\",\\n          \\\"value\\\": null,\\n          \\\"on\\\": [\\n            {\\n              \\\"events\\\": \\\"@brushRect:pointerdown\\\",\\n              \\\"update\\\": \\\"slice(brush)\\\"\\n            }\\n          ]\\n        },\\n        {\\n          \\\"name\\\": \\\"down\\\",\\n          \\\"value\\\": [\\n            0,\\n            0\\n          ],\\n          \\\"on\\\": [\\n            {\\n              \\\"events\\\": \\\"@brushRect:pointerdown\\\",\\n              \\\"update\\\": \\\"[x(), y('overview')]\\\"\\n            }\\n          ]\\n        },\\n        {\\n          \\\"name\\\": \\\"delta\\\",\\n          \\\"value\\\": [\\n            0,\\n            0\\n          ],\\n          \\\"on\\\": [\\n            {\\n              \\\"events\\\": \\\"[@brushRect:pointerdown, window:pointerup] > @brushRect:pointermove!\\\",\\n              \\\"update\\\": \\\"[x() - down[0],  y('overview') - down[1]]\\\"\\n            }\\n          ]\\n        },\\n        // Calculates and pushes X scale outward\\n        {\\n          \\\"name\\\": \\\"xDetailZoom\\\",\\n          \\\"push\\\": \\\"outer\\\",\\n          \\\"on\\\": [\\n            {\\n              \\\"events\\\": {\\n                \\\"signal\\\": \\\"brush\\\"\\n              },\\n              \\\"update\\\": \\\"(span(brush[0]) ? invert('xOverview', brush[0]) : null)\\\"\\n            }\\n          ]\\n        },\\n        // Calculates and pushes Y scale outward\\n        {\\n          \\\"name\\\": \\\"yDetailZoom\\\",\\n          \\\"push\\\": \\\"outer\\\",\\n          \\\"on\\\": [\\n            {\\n              \\\"events\\\": {\\n                \\\"signal\\\": \\\"brush\\\"\\n              },\\n              \\\"update\\\": \\\"(span(brush[1]) ? reverse(invert('yOverview', brush[1])) : null)\\\"\\n            }\\n          ]\\n        }\\n      ],\\n      \\\"scales\\\": [\\n        {\\n          \\\"name\\\": \\\"xOverview\\\",\\n          \\\"type\\\": \\\"time\\\",\\n          \\\"range\\\": [\\n            0,\\n            {\\n              \\\"signal\\\": \\\"graphWidth\\\"\\n            }\\n          ],\\n          \\\"nice\\\": true,\\n          \\\"domain\\\": {\\n            \\\"data\\\": \\\"markData\\\",\\n            \\\"field\\\": \\\"timestamp\\\"\\n          }\\n        },\\n        {\\n          \\\"name\\\": \\\"yOverview\\\",\\n          \\\"type\\\": \\\"symlog\\\",\\n          \\\"range\\\": [\\n            {\\n              \\\"signal\\\": \\\"lowerHeight\\\"\\n            },\\n            10\\n          ],\\n          \\\"nice\\\": true,\\n          \\\"domain\\\": {\\n            \\\"data\\\": \\\"markData\\\",\\n            \\\"field\\\": \\\"value\\\"\\n          }\\n        }\\n      ],\\n      \\\"axes\\\": [\\n        {\\n          \\\"scale\\\": \\\"xOverview\\\",\\n          \\\"orient\\\": \\\"bottom\\\",\\n          \\\"labels\\\": false\\n        },\\n        {\\n          \\\"scale\\\": \\\"yOverview\\\",\\n          \\\"orient\\\": \\\"left\\\",\\n          \\\"labels\\\": false\\n        }\\n      ],\\n      \\\"marks\\\": [\\n        {\\n          \\\"type\\\": \\\"group\\\",\\n          \\\"from\\\": {\\n            \\\"facet\\\": {\\n              \\\"name\\\": \\\"series\\\",\\n              \\\"data\\\": \\\"markData\\\",\\n              \\\"groupby\\\": \\\"addr\\\"\\n            }\\n          },\\n          \\\"marks\\\": [\\n            {\\n              \\\"type\\\": \\\"line\\\",\\n              \\\"interactive\\\": false,\\n              \\\"from\\\": {\\n                \\\"data\\\": \\\"series\\\"\\n              },\\n              \\\"encode\\\": {\\n                \\\"enter\\\": {\\n                  \\\"x\\\": {\\n                    \\\"scale\\\": \\\"xOverview\\\",\\n                    \\\"field\\\": \\\"timestamp\\\"\\n                  },\\n                  \\\"y\\\": {\\n                    \\\"scale\\\": \\\"yOverview\\\",\\n                    \\\"field\\\": \\\"value\\\"\\n                  },\\n                  \\\"interpolate\\\": {\\n                    \\\"signal\\\": \\\"interpolate\\\"\\n                  }\\n                },\\n                \\\"update\\\": {\\n                  \\\"opacity\\\": [\\n                    {\\n                      \\\"test\\\": \\\"!length(data('selected')) || indata('selected', 'value', datum.addr)\\\",\\n                      \\\"value\\\": 1\\n                    },\\n                    {\\n                      \\\"value\\\": 0.25\\n                    }\\n                  ],\\n                  \\\"stroke\\\": [\\n                    {\\n                      \\\"test\\\": \\\"!length(data('selected')) || indata('selected', 'value', datum.addr)\\\",\\n                      \\\"scale\\\": \\\"color\\\",\\n                      \\\"field\\\": \\\"addr\\\"\\n                    },\\n                    {\\n                      \\\"value\\\": \\\"#ccc\\\"\\n                    }\\n                  ]\\n                }\\n              }\\n            },\\n            {\\n              \\\"type\\\": \\\"symbol\\\",\\n              \\\"name\\\": \\\"infoDot\\\",\\n              \\\"from\\\": {\\n                \\\"data\\\": \\\"series\\\"\\n              },\\n              \\\"interactive\\\": false,\\n              \\\"encode\\\": {\\n                \\\"enter\\\": {\\n                  \\\"x\\\": {\\n                    \\\"scale\\\": \\\"xOverview\\\",\\n                    \\\"field\\\": \\\"timestamp\\\"\\n                  },\\n                  \\\"y\\\": {\\n                    \\\"scale\\\": \\\"yOverview\\\",\\n                    \\\"field\\\": \\\"value\\\"\\n                  },\\n                  \\\"interpolate\\\": {\\n                    \\\"signal\\\": \\\"interpolate\\\"\\n                  }\\n                },\\n                \\\"update\\\": {\\n                  \\\"opacity\\\": [\\n                    {\\n                      \\\"test\\\": \\\"!length(data('selected')) || indata('selected', 'value', datum.addr)\\\",\\n                      \\\"value\\\": 1\\n                    },\\n                    {\\n                      \\\"value\\\": 0.25\\n                    }\\n                  ],\\n                  \\\"fill\\\": [\\n                    {\\n                      \\\"test\\\": \\\"!length(data('selected')) || indata('selected', 'value', datum.addr)\\\",\\n                      \\\"signal\\\": \\\"(datum.addr === hoveredTimestamp[0] && datum.timestamp === hoveredTimestamp[1]) ? 'orange' : scale('color', datum.addr)\\\"\\n                    }\\n                  ],\\n                  \\\"size\\\": [ \\n                    {\\n                      \\\"test\\\": \\\"datum.execute_count === '0'\\\",\\n                      \\\"value\\\": [50]\\n                    },\\n                    {\\n                      \\\"scale\\\": \\\"nodeSize\\\", \\\"field\\\": \\\"execute_count\\\"\\n                    } \\n                  ],\\n                  \\\"shape\\\": {\\\"scale\\\": \\\"nodeShape\\\", \\\"field\\\": \\\"func\\\"}\\n                }\\n              }\\n            },\\n            // Shows the selected points\\n            {\\n              \\\"type\\\": \\\"rect\\\",\\n              \\\"name\\\": \\\"brushRect\\\",\\n              \\\"encode\\\": {\\n                \\\"enter\\\": {\\n                  \\\"fill\\\": {\\n                    \\\"value\\\": \\\"#333\\\"\\n                  },\\n                  \\\"fillOpacity\\\": {\\n                    \\\"value\\\": 0.2\\n                  }\\n                },\\n                \\\"update\\\": {\\n                  \\\"x\\\": {\\n                    \\\"signal\\\": \\\"brush[0][0]\\\"\\n                  },\\n                  \\\"x2\\\": {\\n                    \\\"signal\\\": \\\"brush[0][1]\\\"\\n                  },\\n                  \\\"y\\\": {\\n                    \\\"signal\\\": \\\"brush[1][0]\\\"\\n                  },\\n                  \\\"y2\\\": {\\n                    \\\"signal\\\": \\\"brush[1][1]\\\"\\n                  }\\n                }\\n              }\\n            },\\n            {\\n              \\\"type\\\": \\\"rule\\\",\\n              \\\"interactive\\\": false,\\n              \\\"encode\\\": {\\n                \\\"enter\\\": {\\n                  \\\"y2\\\": {\\n                    \\\"signal\\\": \\\"lowerHeight + 10\\\"\\n                  }\\n                },\\n                \\\"update\\\": {\\n                  \\\"x\\\": {\\n                    \\\"signal\\\": \\\"brush[0][0]\\\"\\n                  }\\n                }\\n              }\\n            },\\n            {\\n              \\\"type\\\": \\\"rule\\\",\\n              \\\"interactive\\\": false,\\n              \\\"encode\\\": {\\n                \\\"enter\\\": {\\n                  \\\"y2\\\": {\\n                    \\\"signal\\\": \\\"lowerHeight + 10\\\"\\n                  }\\n                },\\n                \\\"update\\\": {\\n                  \\\"x\\\": {\\n                    \\\"signal\\\": \\\"brush[0][1]\\\"\\n                  }\\n                }\\n              }\\n            },\\n            {\\n              \\\"type\\\": \\\"rule\\\",\\n              \\\"interactive\\\": false,\\n              \\\"encode\\\": {\\n                \\\"enter\\\": {\\n                  \\\"x2\\\": {\\n                    \\\"signal\\\": \\\"graphWidth\\\"\\n                  },\\n                  \\\"y\\\": {\\n                    \\\"signal\\\": \\\"lowerHeight\\\"\\n                  }\\n                },\\n                \\\"update\\\": {\\n                  \\\"y\\\": {\\n                    \\\"signal\\\": \\\"brush[1][0]\\\"\\n                  }\\n                }\\n              }\\n            },\\n            {\\n              \\\"type\\\": \\\"rule\\\",\\n              \\\"interactive\\\": false,\\n              \\\"encode\\\": {\\n                \\\"enter\\\": {\\n                  \\\"x2\\\": {\\n                    \\\"signal\\\": \\\"graphWidth\\\"\\n                  },\\n                  \\\"y\\\": {\\n                    \\\"signal\\\": \\\"lowerHeight\\\"\\n                  }\\n                },\\n                \\\"update\\\": {\\n                  \\\"y\\\": {\\n                    \\\"signal\\\": \\\"brush[1][1]\\\"\\n                  }\\n                }\\n              }\\n            }\\n          ]\\n        }\\n      ]\\n    },\\n    /****** START IP SELECT TABLE ******/\\n    // We're doing a table since we can not (as of now) update binds dynamically\\n    {\\n      \\\"type\\\": \\\"group\\\",\\n      \\\"name\\\": \\\"ipSelect\\\",\\n      \\\"signals\\\": [\\n        {\\n          \\\"name\\\": \\\"scrollBarWidth\\\",\\n          \\\"update\\\": \\\"ipsToDisplay < minIps ? 0 : 12\\\"\\n        },\\n        {\\n          \\\"name\\\": \\\"scrollbarFillOpacity\\\",\\n          \\\"value\\\": 0.2,\\n          \\\"on\\\": [\\n            {\\n              \\\"events\\\": \\\"@rect-scrollbar:mouseover\\\",\\n              \\\"update\\\": \\\"0.4\\\"\\n            },\\n            {\\n              \\\"events\\\": \\\"@rect-scrollbar:mouseout\\\",\\n              \\\"update\\\": \\\"0.2\\\"\\n            }\\n          ]\\n        }\\n      ],\\n      \\\"scales\\\": [\\n        {\\n          \\\"name\\\": \\\"yScale\\\",\\n          \\\"type\\\": \\\"band\\\",\\n          \\\"domain\\\": {\\n            \\\"data\\\": \\\"ipSlice\\\",\\n            \\\"field\\\": \\\"destIp\\\",\\n            \\\"sort\\\": true\\n          },\\n          \\\"range\\\": [\\n            0,\\n            {\\n              \\\"signal\\\": \\\"rowHeight * length(data('ipSlice'))\\\"\\n            }\\n          ]\\n        }\\n      ],\\n      \\\"marks\\\": [\\n        {\\n          \\\"type\\\": \\\"text\\\",\\n          \\\"encode\\\": {\\n            \\\"enter\\\": {\\n              \\\"text\\\": {\\n                \\\"value\\\": \\\"IP Selection\\\"\\n              },\\n              \\\"width\\\": {\\n                \\\"signal\\\": \\\"width - ipSelectX - 20\\\"\\n              },\\n              \\\"x\\\": {\\n                \\\"signal\\\": \\\"ipSelectX\\\"\\n              },\\n              \\\"dy\\\": {\\n                \\\"value\\\": -5\\n              }\\n            }\\n          }\\n        },\\n        {\\n          \\\"name\\\": \\\"rule-scrolltrack-1\\\",\\n          \\\"type\\\": \\\"rule\\\",\\n          \\\"encode\\\": {\\n            \\\"update\\\": {\\n              \\\"x\\\": {\\n                \\\"signal\\\": \\\"width - scrollBarWidth - 2\\\"\\n              },\\n              \\\"x2\\\": {\\n                \\\"signal\\\": \\\"width - scrollBarWidth - 2\\\"\\n              },\\n              \\\"y2\\\": {\\n                \\\"signal\\\": \\\"ipsScrollAreaHeight\\\"\\n              },\\n              \\\"stroke\\\": {\\n                \\\"value\\\": \\\"black\\\"\\n              },\\n              \\\"strokeWidth\\\": {\\n                \\\"signal\\\": \\\"!scrollBarWidth ? 0 : 0.2\\\"\\n              }\\n            }\\n          }\\n        },\\n        {\\n          \\\"name\\\": \\\"rule-scrolltrack-2\\\",\\n          \\\"type\\\": \\\"rule\\\",\\n          \\\"encode\\\": {\\n            \\\"update\\\": {\\n              \\\"x\\\": {\\n                \\\"signal\\\": \\\"width\\\"\\n              },\\n              \\\"x2\\\": {\\n                \\\"signal\\\": \\\"width\\\"\\n              },\\n              \\\"y2\\\": {\\n                \\\"signal\\\": \\\"ipsScrollAreaHeight\\\"\\n              },\\n              \\\"stroke\\\": {\\n                \\\"value\\\": \\\"black\\\"\\n              },\\n              \\\"strokeWidth\\\": {\\n                \\\"signal\\\": \\\"!scrollBarWidth ? 0 : 0.2\\\"\\n              }\\n            }\\n          }\\n        },\\n        {\\n          \\\"name\\\": \\\"rect-scrollbar\\\",\\n          \\\"type\\\": \\\"rect\\\",\\n          \\\"encode\\\": {\\n            \\\"update\\\": {\\n              \\\"x\\\": {\\n                \\\"signal\\\": \\\"width - scrollBarWidth - 1\\\"\\n              },\\n              \\\"y\\\": {\\n                \\\"scale\\\": \\\"ipsScaleScrollBarY\\\",\\n                \\\"signal\\\": \\\"ipsScrollPosition\\\"\\n              },\\n              \\\"width\\\": {\\n                \\\"signal\\\": \\\"scrollBarWidth\\\"\\n              },\\n              \\\"height\\\": {\\n                \\\"signal\\\": \\\"ipsScrollBarHeight\\\"\\n              },\\n              \\\"fill\\\": {\\n                \\\"value\\\": \\\"#666666\\\"\\n              },\\n              \\\"fillOpacity\\\": {\\n                \\\"signal\\\": \\\"scrollbarFillOpacity\\\"\\n              }\\n            }\\n          }\\n        },\\n        {\\n          \\\"name\\\": \\\"destIps-rect-cell\\\",\\n          \\\"type\\\": \\\"rect\\\",\\n          \\\"from\\\": {\\n            \\\"data\\\": \\\"ipSlice\\\"\\n          },\\n          \\\"encode\\\": {\\n            \\\"update\\\": {\\n              \\\"x\\\": {\\n                \\\"signal\\\": \\\"ipSelectX\\\"\\n              },\\n              \\\"x2\\\": {\\n                \\\"signal\\\": \\\"width - scrollBarWidth - 3\\\"\\n              },\\n              \\\"y\\\": {\\n                \\\"scale\\\": \\\"yScale\\\",\\n                \\\"field\\\": \\\"destIp\\\",\\n                \\\"band\\\": 0\\n              },\\n              \\\"cursor\\\": {\\n                \\\"value\\\": \\\"pointer\\\"\\n              },\\n              \\\"height\\\": {\\n                \\\"signal\\\": \\\"rowHeight\\\"\\n              },\\n              \\\"opacity\\\": [\\n                {\\n                  \\\"test\\\": \\\"datum.destIp === selectedIp\\\",\\n                  \\\"value\\\": 0.4\\n                },\\n                {\\n                  \\\"value\\\": 0.2\\n                }\\n              ]\\n            }\\n          }\\n        },\\n        {\\n          \\\"name\\\": \\\"destIps-text-content\\\",\\n          \\\"type\\\": \\\"text\\\",\\n          \\\"from\\\": {\\n            \\\"data\\\": \\\"ipSlice\\\"\\n          },\\n          \\\"encode\\\": {\\n            \\\"update\\\": {\\n              \\\"text\\\": {\\n                \\\"signal\\\": \\\"datum.destIp\\\"\\n              },\\n              \\\"x\\\": {\\n                \\\"signal\\\": \\\"ipSelectX\\\"\\n              },\\n              \\\"dx\\\": {\\n                \\\"value\\\": 5\\n              },\\n              \\\"y\\\": {\\n                \\\"scale\\\": \\\"yScale\\\",\\n                \\\"field\\\": \\\"destIp\\\",\\n                \\\"band\\\": 0.5\\n              },\\n              \\\"cursor\\\": {\\n                \\\"value\\\": \\\"pointer\\\"\\n              }\\n            }\\n          }\\n        }\\n      ]\\n    },\\n  ]\\n}\\n\"}}"
      },
      "id": "d7f669a0-cfa1-11f0-b77d-79037ad18c51",
      "migrationVersion": {
        "visualization": "7.10.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [],
      "type": "visualization",
      "updated_at": "2025-12-02T17:10:46.841Z",
      "version": "WzEyOTAsMV0="
    },
    {
      "attributes": {
        "columns": [
          "source.ip",
          "destination.ip",
          "destination.port",
          "event.action",
          "zeek.dnp3.fc_reply",
          "zeek.dnp3.iin_flags",
          "event.id"
        ],
        "description": "",
        "hits": 0,
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"highlightAll\":false,\"version\":true,\"filter\":[],\"query\":{\"query\":{\"query_string\":{\"query\":\"event.dataset:dnp3\",\"analyze_wildcard\":true}},\"language\":\"lucene\"},\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"
        },
        "sort": [
          [
            "MALCOLM_NETWORK_INDEX_TIME_FIELD_REPLACER",
            "desc"
          ]
        ],
        "title": "DNP3 - Logs",
        "version": 1
      },
      "id": "cc135a63-3e30-4703-bc31-f7ac09c1d21a",
      "migrationVersion": {
        "search": "7.9.3"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "MALCOLM_NETWORK_INDEX_PATTERN_REPLACER",
          "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
          "type": "index-pattern"
        }
      ],
      "type": "search",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNzIsMV0="
    },
    {
      "attributes": {
        "columns": [
          "source.ip",
          "destination.ip",
          "zeek.dnp3_control.function_code",
          "zeek.dnp3_control.trip_control_code",
          "zeek.dnp3_control.operation_type",
          "zeek.dnp3_control.clear_bit",
          "zeek.dnp3_control.status_code"
        ],
        "description": "",
        "hits": 0,
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"highlightAll\":false,\"version\":true,\"filter\":[],\"query\":{\"query\":\"event.dataset:dnp3_control\",\"language\":\"lucene\"},\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"
        },
        "sort": [
          [
            "MALCOLM_NETWORK_INDEX_TIME_FIELD_REPLACER",
            "desc"
          ]
        ],
        "title": "DNP3 - Control Logs",
        "version": 1
      },
      "id": "980f33d0-cb65-11ea-b8b9-778c41cae039",
      "migrationVersion": {
        "search": "7.9.3"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "MALCOLM_NETWORK_INDEX_PATTERN_REPLACER",
          "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
          "type": "index-pattern"
        }
      ],
      "type": "search",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNzMsMV0="
    },
    {
      "attributes": {
        "columns": [
          "source.ip",
          "destination.ip",
          "event.action",
          "zeek.dnp3_objects.object_type",
          "zeek.dnp3_objects.object_count",
          "zeek.dnp3_objects.range_high",
          "zeek.dnp3_objects.range_low"
        ],
        "description": "",
        "hits": 0,
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": "{\"highlightAll\":false,\"version\":true,\"filter\":[],\"query\":{\"query\":\"event.dataset:dnp3_objects\",\"language\":\"lucene\"},\"indexRefName\":\"kibanaSavedObjectMeta.searchSourceJSON.index\"}"
        },
        "sort": [
          [
            "MALCOLM_NETWORK_INDEX_TIME_FIELD_REPLACER",
            "desc"
          ]
        ],
        "title": "DNP3 - Objects Logs",
        "version": 1
      },
      "id": "cf32a680-cb65-11ea-b8b9-778c41cae039",
      "migrationVersion": {
        "search": "7.9.3"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "MALCOLM_NETWORK_INDEX_PATTERN_REPLACER",
          "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
          "type": "index-pattern"
        }
      ],
      "type": "search",
      "updated_at": "2025-12-02T16:23:42.854Z",
      "version": "WzEyNzQsMV0="
    }
  ],
  "version": "3.3.0"
}
