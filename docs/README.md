# <a name="Overview"></a>Overview

![Malcolm Network Diagram](./images/malcolm_network_diagram.png)

Malcolm processes network traffic data in the form of packet capture (PCAP) files or Zeek logs. A [sensor](live-analysis.md#Hedgehog) (packet capture appliance) monitors network traffic mirrored to it over a SPAN port on a network switch or router, or by using a network TAP device. [Zeek](https://www.zeek.org/index.html) logs and [Arkime](https://arkime.com/) sessions are generated containing important session metadata from the traffic observed, which are then securely forwarded to a Malcolm instance. Full PCAP files are optionally stored locally on the sensor device for later examination.

Malcolm parses the network session data and enriches it with additional lookups and mappings including GeoIP mapping, hardware manufacturer lookups from [organizationally unique identifiers (docs/OUI)](http://standards-oui.ieee.org/oui/oui.txt) in MAC addresses, assigning names to [network segments and hosts](asset-interaction-analysis.md#AssetInteractionAnalysis) based on a user-defined asset inventory, performing [JA4 fingerprinting](https://blog.foxio.io/ja4%2B-network-fingerprinting), and many others.

This enriched data is stored in an [OpenSearch](https://opensearch.org/) document in a format suitable for analysis through two intuitive interfaces: OpenSearch Dashboards, a flexible data visualization plugin with dozens of prebuilt dashboards providing an at-a-glance overview of network protocols; and Arkime, a powerful tool for finding and identifying the network sessions comprising suspected security incidents. These tools can be accessed through a web browser from analyst workstations or on a display in a security operations center (SOC). Logs can also be forwarded on to another instance of Malcolm.

![Malcolm Data Pipeline](./images/malcolm_data_pipeline.png)

Malcolm can also easily be deployed locally on an ordinary consumer workstation or laptop for smaller networks, use at home, or in the field incident response engagements. Malcolm can process local artifacts such as locally generated Zeek logs, locally captured PCAP files, and PCAP files collected offline without the use of a dedicated sensor appliance.

<a name="TableOfContents"></a>

* [Quick start](quickstart.md#QuickStart)
    - [Getting Malcolm](quickstart.md#GetMalcolm)
    - [User interface](quickstart.md#UserInterfaceURLs)
    - [Docker vs. Podman](quickstart.md#DockerVPodman)
* [Components](components.md#Components)
* [Supported Protocols](protocols.md#Protocols)
* [Downloading Malcolm](download.md#DownloadMalcolm)
    - [Container images](download.md#DownloadDockerImages)
    - [Installer ISOs](download.md#DownloadISOs)
* [Development](development.md#Development)
    - [Building from source](development.md#Build)
    - [Pre-Packaged installation files](development.md#Packager)
* [Configuration](malcolm-preparation.md#Configuration)
    - [Recommended system requirements](system-requirements.md#SystemRequirements)
    - [Malcolm Configuration](malcolm-config.md#ConfigAndTuning)
        + [Environment variable files](malcolm-config.md#MalcolmConfigEnvVars)
        + [Command-line arguments](malcolm-config.md#CommandLineConfig)
        + [Managing disk usage](malcolm-config.md#DiskUsage)
    - [Configure authentication](authsetup.md#AuthSetup)
        + [Local account management](authsetup.md#AuthBasicAccountManagement)
        + [Lightweight Directory Access Protocol (LDAP) authentication](authsetup.md#AuthLDAP)
            * [LDAP connection security](authsetup.md#AuthLDAPSecurity)
        + [Keycloak](authsetup.md#AuthKeycloak)
            * [Using a remote Keycloak instance](authsetup.md#AuthKeycloakRemote)
            * [Using the embedded Keycloak instance](authsetup.md#AuthKeycloakEmbedded)
            * [Known Limitation with Hedgehog Linux](authsetup.md#AuthKeycloakHedgehog)
            * [Groups and roles](authsetup.md#AuthKeycloakGroupsRoles)
                - [Role-based access control](authsetup.md#AuthKeycloakRBAC)
                - [System-wide required user groups and realm roles](authsetup.md#AuthKeycloakReqGroupsRoles)
                - [Configuring Keycloak to pass groups and roles to Malcolm](authsetup.md#AuthKeycloakGroupsAndRolesConfig)
        + [TLS certificates](authsetup.md#TLSCerts)
        + [Command-line arguments](authsetup.md#CommandLineConfig)
    - [Log Out of Malcolm](authsetup.md#LoggingOut)
    - [Platform-specific Configuration](host-config.md#HostSystemConfig)
        + [Linux host system configuration](host-config-linux.md#HostSystemConfigLinux)
        + [macOS host system configuration](host-config-macos.md#HostSystemConfigMac)
        + [Windows host system configuration](host-config-windows.md#HostSystemConfigWindows)
    - [Managing disk usage](malcolm-config.md#DiskUsage)
* [Running Malcolm](running.md#Running)
    - [OpenSearch and Elasticsearch instances](opensearch-instances.md#OpenSearchInstance)
        + [Authentication and authorization for remote data store clusters](opensearch-instances.md#OpenSearchAuth)
    - [Starting Malcolm](running.md#Starting)
    - [Stopping and restarting Malcolm](running.md#StopAndRestart)
    - [Clearing Malcolm's data](running.md#Wipe)
    - [Temporary read-only interface](running.md#ReadOnlyUI)
* [Network traffic artifact upload](upload.md#Upload)
    - [Tagging](upload.md#Tagging)
    - [NetBox site](upload.md#UploadNetBoxSite)
* [Live analysis](live-analysis.md#LiveAnalysis)
    - [Using a network sensor appliance](live-analysis.md#Hedgehog)
    - [Monitoring local network interfaces](live-analysis.md#LocalPCAP)
        + ["Hedgehog" run profile](live-analysis.md#Profiles)
    - [Manually forwarding logs from an external source](live-analysis.md#ExternalForward)
    - [Tuning](live-analysis.md#LiveAnalysisTuning)
        + [Zeek](live-analysis.md#LiveAnalysisTuningZeek)
        + [Arkime](live-analysis.md#LiveAnalysisTuningArkime)
        + [Suricata](live-analysis.md#LiveAnalysisTuningSuricata)
* [Arkime](arkime.md#Arkime)
    - [Zeek log integration](arkime.md#ArkimeZeek)
        + [Correlating Zeek logs and Arkime sessions](arkime.md#ZeekArkimeFlowCorrelation)
    - [Help](arkime.md#ArkimeHelp)
    - [Sessions](arkime.md#ArkimeSessions)
        + [PCAP Export](arkime.md#ArkimePCAPExport)
    - [SPIView](arkime.md#ArkimeSPIView)
    - [SPIGraph](arkime.md#ArkimeSPIGraph)
    - [Connections](arkime.md#ArkimeConnections)
    - [Hunt](arkime.md#ArkimeHunt)
    - [Statistics](arkime.md#ArkimeStats)
    - [Settings](arkime.md#ArkimeSettings)
* [OpenSearch Dashboards](dashboards.md#Dashboards)
    - [Discover](dashboards.md#Discover)
        + [Screenshots](dashboards.md#DiscoverGallery)
    - [Visualizations and dashboards](dashboards.md#DashboardsVisualizations)
        + [Prebuilt visualizations and dashboards](dashboards.md#PrebuiltVisualizations)
            * [Screenshots](dashboards.md#PrebuiltVisualizationsGallery)
        + [Building your own visualizations and dashboards](dashboards.md#BuildDashboard)
            * [Screenshots](dashboards.md#NewVisualizationsGallery)
    - [Anomaly Detection](anomaly-detection.md#AnomalyDetection)
    - [Reporting](reporting.md#Reporting)
    - [Alerting](alerting.md#Alerting)
        + [Email Sender Accounts](alerting.md#AlertingEmail)
* [Search Queries in Arkime and OpenSearch Dashboards](queries-cheat-sheet.md#SearchCheatSheet)
* Other Malcolm features
    - [Custom Rules, Scripts and Plugins](custom-rules.md#CustomRulesAndScripts)
        + [Arkime](custom-rules.md#Arkime)
        + [Suricata](custom-rules.md#Suricata)
        + [Zeek](custom-rules.md#Zeek)
        + [YARA](custom-rules.md#YARA)
        + [NetBox Plugins](custom-rules.md#NetBox)
        + [Logstash Output Pipelines](custom-rules.md#Logstash)
        + [Other Customizations](custom-rules.md#Other)
    - [Automatic file extraction and scanning](file-scanning.md#ZeekFileExtraction)
        + [User interface](file-scanning.md#ZeekFileExtractionUI)
    - [Index management](index-management.md)
        + [OpenSearch index management](index-management.md#OpenSearchIndexManagement)
        + [Using ILM/ISM with Arkime](index-management.md#ArkimeIndexPolicies)
    - [Event severity scoring](severity.md#Severity)
        + [Customizing event severity scoring](severity.md#SeverityConfig)
    - [Zeek Intelligence Framework](zeek-intel.md#ZeekIntel)
        + [STIX™ and TAXII™](zeek-intel.md#ZeekIntelSTIX)
        + [MISP](zeek-intel.md#ZeekIntelMISP)
        + [Mandiant](zeek-intel.md#ZeekIntelMandiant)
    - ["Best Guess" Fingerprinting for ICS Protocols](ics-best-guess.md#ICSBestGuess)
    - [Asset Interaction Analysis](asset-interaction-analysis.md#AssetInteractionAnalysis)
        + [Enriching network traffic metadata via NetBox lookups](asset-interaction-analysis.md#NetBoxEnrichment)
        + [Compare and highlight discrepancies between NetBox inventory and observed network traffic](asset-interaction-analysis.md#NetBoxCompare)
        + Populating the NetBox inventory
            * [Manually](asset-interaction-analysis.md#NetBoxPopManual)
            * [Via passively-gathered network traffic metadata](asset-interaction-analysis.md#NetBoxPopPassive)
                - [Subnets considered for autopopulation](asset-interaction-analysis.md#NetBoxAutoPopSubnets)
                - [Matching device manufacturers to OUIs](asset-interaction-analysis.md#NetBoxPopPassiveOUIMatch)
            * [Via active discovery](asset-interaction-analysis.md#NetBoxPopActive)
        + [Compare NetBox inventory with database of known vulnerabilities](asset-interaction-analysis.md#NetBoxVuln)
        + [Preloading NetBox inventory](asset-interaction-analysis.md#NetBoxPreload)
        + [Backup and restore](asset-interaction-analysis.md#NetBoxBackup)
    - [CyberChef](cyberchef.md#CyberChef)
    - [API](api.md#API)
* [Forwarding Third-Party Logs to Malcolm](third-party-logs.md#ThirdPartyLogs)
* [Malcolm installer ISO](malcolm-iso.md#ISO)
    - [Installation](malcolm-iso.md#ISOInstallation)
    - [Generating the ISO](malcolm-iso.md#ISOBuild)
    - [Setup](malcolm-iso.md#ISOSetup)
    - [Time synchronization](time-sync.md#ConfigTime)
* [Deploying Malcolm with Kubernetes](kubernetes.md#Kubernetes)
    - [Configuration](kubernetes.md#Config)
    - [Running Malcolm](kubernetes.md#Running)
    - [Deployment Example](kubernetes.md#Example)
    - [Future Enhancements](kubernetes.md#Future)
* [Deploying Malcolm on Amazon Web Services (AWS)](aws.md#AWS)
    - [Installing prerequisites](aws.md#AWSPrereqInstall)
    - [Amazon EC2 Instance Types](aws.md#AWSInstanceSizing)
    - [Installing Malcolm in an EC2 instance](aws.md#AWSEC2)
        + [Instance creation](aws.md#AWSEC2Instance)
        + [Malcolm setup](aws.md#AWSEC2Install)
        + [Running Malcolm](aws.md#AWSEC2Run)
    - [Deploying Malcolm on Amazon Elastic Kubernetes Service (EKS)](aws.md#KubernetesEKS)
        + [Deploying with EKS](aws.md#AWSEKS)
        + [Deploying with EKS Auto Mode](aws.md#AWSEKSAuto)
        + [Common Steps for EKS Deployments](aws.md#AWSEKSCommon)
    - [Generating a Malcolm Amazon Machine Image (AMI)](aws.md#AWSAMI)
        + [Launching an EC2 instance from the Malcolm AMI](aws.md#AWSAMILaunch)
        + [Using MFA](aws.md#AWSAMIMFA)
    - [Attribution and Disclaimer](aws.md#AWSAttribution)
* [Hardening](hardening.md#Hardening)
    - [Compliance Exceptions](hardening.md#ComplianceExceptions)
* [Installation example using Ubuntu 24.04 LTS](ubuntu-install-example.md#InstallationExample)
* [Upgrading Malcolm](malcolm-upgrade.md#UpgradePlan)
* [Modifying or Contributing to Malcolm](contributing-guide.md#Contributing)
    - [Local modifications](contributing-local-modifications.md#LocalMods)
    - [Adding a new service (image)](contributing-new-image.md#NewImage)
    - [Adding new log fields](contributing-new-log-fields.md#NewFields)
    - [Zeek](contributing-zeek.md#Zeek)
    - [PCAP processors](contributing-pcap.md#PCAP)
    - [Logstash](contributing-logstash.md#Logstash)
    - [OpenSearch Dashboards](contributing-dashboards.md#dashboards)
    - [Carved file scanners](contributing-file-scanners.md#Scanners)
    - [Style](contributing-style.md#Style)
    - [Using GitHub runners to build Malcolm images](contributing-github-runners.md#GitHubRunners)
    - [Preparing a Malcolm Release](contributing-release-prep.md)